sw_auth Authentication Module (Sentiweb team)
============================================

Purpose
-------
Separate identification data from collected data.

How it works 
------------

The swauth module replace 'account' module and django-registration. It handles registration, password and user settings management.  

All users are registred in a new table and django auth_user table is anonymized (django username are replaced with a random string and identication data are removed).

The new table contains the django username in a crypted field.

When a user log in :
 - authentication is made using the identification data in the sw_auth table
 - if successfull, the corresponding django username is disclosed
 - a proxy object of django.core.auth.User class is instancied with the django user and stored as 'user' field in session
 - real identification data (login and email) are copied
 
Why the 'Fake' user class:
* Allow the user to see its real login and email 
* Protect this real data from being saved in the regular auth_user django table (save method raise an exception)

A new table contains all identification data
 swauth_epiworkuser
   id    = id of the user (in the new system)
   login = login of the user
   email = email of the user
   user = ciphered username of the corresponding django user

Installation
---------------
* register apps/sw_auth
* remove/comment middleware 'django.contrib.auth.middleware.AuthenticationMiddleware',
* register middleware  'apps.sw_auth.middleware.AuthenticationMiddleware',
* register auth backend  'apps.sw_auth.backend.EpiworkAuthBackend',
* Migrate db
* Reminder app won't work anymore => use reminder_send_plus (@see reminder app)
* Replace all urls mapping /account/* with swauth views

Config
------

Add in local_settings.py

```python
 SWAUTH_AES_KEY = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'
```

Where key could be generated by
```python
 import os, base64
 base64.b64encode(os.urandom(32))
``` 

To activate fake user usage (in reminder apps)
```python
SWAUTH_FAKE_USER = 1
``` 

Commands
-------

* swauth_transfert : Transfer django accounts to swauth accounts and anonymize django
* swauth_anonymize : Anonymize a swauth account
* swauth_activate : manage user activation (renew activation token)
* swauth_disclose : disclose identity (django user 'root' access needed). 